import{a as y}from"./axios-BCTQ_kMI.js";import{u as K}from"./useQuery-BerbIKsq.js";import{d as N,r as i,k as E,o as H,c as P,l as h,m as p,v as t,n as _,u as v,z as r,F as R,y as U,B as Y,K as $,E as A}from"./index-DDgAzDTH.js";import{c as C}from"./createLucideIcon-CTFV4eHW.js";/**
 * @license lucide-vue-next v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=C("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=C("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=C("ClockIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),X={class:"container mx-auto lg:px-4 px-10"},Z={class:"flex flex-row sm:flex-col gap-4 justify-end"},ee={key:0,class:"flex flex-col items-center space-y-8 mt-8"},te={class:"flex flex-col items-center space-y-3"},ae={class:"capitalize text-4xl md:text-lg font-semibold flex items-center"},se={class:"flex items-center gap-5"},oe={class:"flex flex-col items-center"},ne={class:"font-medium md:text-sm text-2xl"},le={class:"font-medium text-lg md:text-xs"},ie={class:"flex flex-col gap-2 bg-white shadow-md md:w-full w-1/3 py-3 items-center text-emerald-700 rounded-xl"},ce={class:"flex items-center gap-3"},re={class:"capitalize font-medium text-lg"},de={class:"font-semibold text-xl"},ue={class:"grid grid-cols-2 lg:grid-cols-2 gap-4 w-full max-w-6xl"},me={class:"flex flex-col text-emerald-700 font-medium"},ge={class:"text-base capitalize"},he={class:"text-xl font-medium"},pe={class:"w-14 h-14 flex items-center justify-center"},fe=["src"],ve={key:1,class:"animate-pulse flex justify-center py-10"},ye=t("span",{class:"text-3xl md:text-lg font-medium"},"Loading...",-1),_e=[ye],xe={key:2,class:"flex justify-center py-10"},we=t("div",{class:"bg-red-300 border border-red-500 rounded-lg container max-w-2xl"},[t("span",{class:"text-red-400"},"Mohon Izinkan Akses Lokasi")],-1),ke=[we],Se=N({__name:"JadwalSholat",setup(De){i(!1);const o=i(new Date),n=i(),x=i(!1),m=i({city:"",cityId:0}),w=i([]),S=i(""),k=i([]),F=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(async s=>{const{latitude:e,longitude:l}=s.coords;try{const a=await y.get(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${l}&zoom=10&addressdetails=1`);m.value={...a.data.address,city:a.data.address.city},await q(m.value.city)}catch(a){console.error("Gagal mendapatkan nama kota:",a),$.error("Gagal mendapatkan lokasi")}})},M=()=>{D(w.value[0].id),I()};async function q(s){try{const e=await y.get(`https://api.myquran.com/v2/sholat/kota/cari/${s}`);e.data.status&&e.data.data.length>0?(w.value=e.data.data,m.value.cityId=e.data.data[0].id,await D(e.data.data[0].id)):$.warning("Kota tidak ditemukan")}catch(e){console.error("Gagal mengambil data kota:",e),$.error("Gagal mengambil data kota")}finally{}}async function D(s){x.value=!0;try{const e=o.value?new Date(o.value):new Date,l=e.getFullYear(),a=e.getMonth()+1,d=e.getDate(),g=await y.get(`https://api.myquran.com/v2/sholat/jadwal/${s}/${l}/${a}/${d}`).then(c=>c.data.data);n.value=g}catch(e){console.error(e)}finally{x.value=!1}}const{data:T,isFetching:V,refetch:I}=K({queryKey:["calendar","hijriyah"],queryFn:async()=>{const s=o.value?new Date(o.value):new Date,e=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");return await y.get(`https://api.myquran.com/v2/cal/hijr/${e}-${l}-${a}`).then(d=>d.data.data)}});i([]),i(!1);const L=s=>{const e=new Date(o.value);e.setDate(e.getDate()+s),o.value=e,D(w.value[0].id),I()},z=()=>{if(!n.value||!n.value.jadwal)return;const s=new Date,l=[{name:"subuh",time:n.value.jadwal.subuh},{name:"dzuhur",time:n.value.jadwal.dzuhur},{name:"ashar",time:n.value.jadwal.ashar},{name:"maghrib",time:n.value.jadwal.maghrib},{name:"isya",time:n.value.jadwal.isya}].map(({name:u,time:b})=>{const[B,G]=b.split(":").map(Number),f=new Date(s);return f.setHours(B,G,0,0),f<s&&f.setDate(f.getDate()+1),{name:u,time:f}}).sort((u,b)=>u.time.getTime()-b.time.getTime());k.value=l[0];const a=k.value.time-s,d=Math.floor(a/(1e3*60*60)),g=Math.floor(a%(1e3*60*60)/(1e3*60)),c=Math.floor(a%(1e3*60)/1e3);S.value=`${String(d).padStart(2,"0")} : ${String(g).padStart(2,"0")} : ${String(c).padStart(2,"0")}`};let j;E(n,()=>{j&&clearInterval(j),z(),j=setInterval(z,1e3)}),H(()=>F());const J=P(()=>{var a;if(!((a=n.value)!=null&&a.jadwal))return{};const{date:s,tanggal:e,...l}=n.value.jadwal;return l});return(s,e)=>{var a,d,g;const l=A("el-date-picker");return h(),p("div",X,[t("div",Z,[_(l,{style:{"--el-color-primary":"#16a34a"},modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=c=>o.value=c),onChange:M,type:"date",clearable:!1,placeholder:"Pilih Tanggal",size:"large"},null,8,["modelValue"])]),!x.value&&!v(V)&&((a=m.value)!=null&&a.city)?(h(),p("div",ee,[t("div",te,[t("span",ae," waktu sholat daerah "+r((d=m.value)==null?void 0:d.city),1),t("div",se,[_(v(Q),{class:"cursor-pointer",onClick:e[1]||(e[1]=c=>L(-1))}),t("div",oe,[t("span",ne,r(o.value.toLocaleDateString("id-ID",{weekday:"long"}))+", "+r(o.value.toLocaleDateString("id-ID",{day:"2-digit"}))+" "+r(o.value.toLocaleDateString("id-ID",{month:"long"})),1),t("span",le,r((g=v(T))==null?void 0:g.date[1]),1)]),_(v(O),{class:"cursor-pointer",onClick:e[2]||(e[2]=c=>L(1))})])]),t("div",ie,[t("div",ce,[_(v(W)),t("span",re,"menuju waktu sholat "+r(k.value.name),1)]),t("span",de,r(S.value),1)]),t("div",ue,[(h(!0),p(R,null,U(J.value,(c,u)=>(h(),p("div",{key:u,class:"bg-white shadow-md rounded-xl p-3 flex items-center justify-between gap-2"},[t("div",me,[t("span",ge,r(u),1),t("span",he,r(c),1)]),t("div",pe,[t("img",{src:`/${u}.png`,class:"w-12 h-12 object-contain filter-invert-green",alt:""},null,8,fe)])]))),128))])])):(h(),p("div",ve,_e)),m.value?Y("",!0):(h(),p("div",xe,ke))])}}});export{Se as default};
